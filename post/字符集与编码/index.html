<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>字符集与编码 - DEVIN 0x01</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="DEVIN 0x01" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">DEVIN 0x01</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">字符集与编码</h1>
			
		</header>
		<div class="content post__content clearfix">
			<h2 id="术语">术语</h2>
<blockquote>
<p><strong>字符</strong>(character)是具有语义值的文本的最小单位。
<strong>字符集</strong>(character set)是可能由多种语言使用的字符的集合。例：拉丁语字符集由英语和大多数欧洲语言使用，但希腊语字符集仅由希腊语使用。
<strong>编码字符集</strong>(coded character set)是一个字符集，其中每个字符对应于一个唯一的数字。
一个编码字符集的<strong>编码点</strong>(code point)是字符集中或编码空间中允许的任何值。
<strong>编码空间</strong>(code space)是一个整数范围，其值为编码点。
<strong>编码单元</strong>(code unit)是一个位序列，用于在给定的编码表单中对库的每个字符进行编码。有的文档中称之为<strong>编码值</strong>(code value)。</p>
</blockquote>
<p>编码单元例子：US-ASCII: 7 bits，UTF-8, GB18030: 8 bits，UTF-16: 16 bits，UTF-32: 32 bits</p>
<p>字符串<code>&quot;abc𐐀&quot;</code> 包括4个字符，4个编码点：
(1) UTF-32编码时: 4个编码单元，00000061, 00000062, 00000063, 00010400
(2) UTF-16编码时: 5个编码单元，0061, 0062, 0063, d801, dc00
(3) UTF-8编码时: 7个编码单元，61, 62, 63, f0, 90, 90, 80</p>
<p><img src="https://cdn.jsdelivr.net/gh/devin0x01/myimages@master/githubpages/image_bbc1f7f685c0d771366f94dbec972ec4.png" alt=""></p>
<h2 id="编码格式区别">编码格式区别</h2>
<p>Unicode、GB2312都是<strong>编码字符集</strong>，即一个编号（数字）到字符的一种映射关系，仅仅是一种映射关系。</p>
<p>GBK、UTF-8都是<strong>编码格式</strong>。GBK和UTF-8都是用来序列化或存储Unicode编码的数据的，但是分别是2种不同的格式。除了格式不一样之外，他们所<strong>关心的unicode编码范围也不一样</strong>，UTF-8考虑了很多种不同国家的字符，涵盖整个Unicode码表，所以其存储一个字符的编码的时候，使用的字节长度也从1字节到4字节不等；而GBK只考虑中文(在Unicode中的一小部分字符的编码），所以它算好了只要2个字节就能涵盖到绝大多数常用中文(2个字节能表示6w多种字符)，所以它存储一个字符的时候，所用的字节长度是固定的。</p>
<h2 id="java中的编码">Java中的编码</h2>
<p>首先Java的String使用的编码是Unicode，但是当String存在于内存中时(也就是当程序运行时，你在代码中用String类型的引用对它进行操作时，也就是String没有被存在文件中且也没有在网络中传输(序列化)时)，是“只有编码而没有编码格式的”，所以Java程序中的任何String对象，说它是GBK还是UTF-8都是错的。GBK和UTF-8是编码格式而不是编码，String在内存中不需要“编码格式”(记住<strong>编码格式是在存文件或序列化的时候使用的</strong>), 它只是一个Unicode的字符串而已。</p>
<p>所以Java里面String是不带编码格式的，而<code>String.toByteArray(String charsetName)</code>得到的<code>byteArray</code>是带编码格式的，格式就是你传入的<code>charsetName</code>，我们不妨把<code>toByteArray</code>的这个过程叫做==编码==；另外，<code>new String(byte bytes[], String charsetName)</code>是把一个byte数组(带编码格式)以charsetName指定的编码格式翻译为一个不带编码格式的String对象，我们不妨把这个过程叫==解码==。</p>
<blockquote>
<p><code>String(byte[] bytes)</code>通过使用平台的默认字符集解码指定的 byte 数组，构造一个新的 String。
<code>String(byte[] bytes, Charset charset)</code>通过使用指定的 charset 解码指定的 byte 数组，构造一个新的 String。</p>
<p><code>byte[] getBytes()</code>使用平台的默认字符集将此 String 编码为 byte 序列，并将结果存储到一个新的 byte数组中。
<code>byte[] getBytes(Charset charset)</code>使用给定的 charset 将此 String 编码到 byte 序列，并将结果存储到新的 byte 数组。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> UnsupportedEncodingException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        String str1<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        String str2<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        str1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;你好&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        bytes <span style="color:#f92672">=</span> str1<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;UTF-8&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 用UTF-8编码序列化到字节数组中
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        str2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">(</span>bytes<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;UTF-8&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 使用UTF-8方式解码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>str2 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;123&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        bytes <span style="color:#f92672">=</span> str1<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;GBK&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        str2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">(</span>bytes<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;GBK&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>str2 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;123&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        bytes <span style="color:#f92672">=</span> str1<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;UTF-8&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        str2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">(</span>bytes<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;GBK&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>str2 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;123&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">// UTF-8编码，GBK解码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        str1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;浣犲ソ&#34;</span><span style="color:#f92672">;</span> <span style="color:#75715e">// 这是&#34;你好&#34;的GBK编码的字符串
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        str2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">(</span>str1<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;GBK&#34;</span><span style="color:#f92672">),</span> <span style="color:#e6db74">&#34;UTF-8&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>str2 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;123&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 输出：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 你好123
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 你好123
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 浣犲ソ123
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 你好123
</span></span></span></code></pre></div><h2 id="参考资料">参考资料</h2>
<p><a href="https://www.zhihu.com/question/20361462">java中GBK编码格式转成UTF8，用一段方法实现怎么做？ - 知乎 (zhihu.com)</a></p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/java/" rel="tag">Java</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 DEVIN 0x01.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>